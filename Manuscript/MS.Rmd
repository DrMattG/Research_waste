---
title: "Maximising the leverage of existing knowledge could reduce research waste in applied ecology and conservation"
csl: nature.csl
output:
  pdf_document:
    fig_caption: yes
  word_document: 
    fig_caption: yes
  html_document: 
    fig_caption: yes
bibliography: bibliography.bib
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```



Matthew J. Grainger^1^*, Frederike C. Bolam^2^, Gavin B. Stewart^2^, Erlend B. Nilsen^1^

^1^Norwegian Institute for Nature Research, P.O. Box 5685 Torgarden, 7485, Trondheim, Norway

^2^Modelling Evidence and Policy Research Group, School of Natural and Environmental Sciences, Ridley Building 2, Claremont Road, Newcastle upon Tyne NE1 7RU, UK  


*corresponding author: matthew.grainger\@nina.no

*Where research does not lead to benefits to society, it may be considered a waste of resources, especially when publicly funded. A formal assessment of the accumulated knowledge prior to research approval would reduce the waste of already limited resources caused by asking low priority questions. There is an urgent need for a change in research workflows so that pre-existing knowledge is better utilised in designing new research.*  

“Research waste” is a well established concept in medical research @glasziou2018research. Research is wasted when its outcomes cannot be used for the benefit of society , for example because no new knowledge is gained or the knowledge gained cannot be applied in practice. Waste can occur at any of the four stages of research @chalmers2009avoidable; question setting; methods; accessibility; and reporting (Figure 1; Table 1). In medicine, research waste was estimated in 2009 to cost US$1bn @chalmers2009avoidable, with little improvement in the last decade1. There is little reason to suspect that the situation is substantially different in ecology and conservation, although there are no field-wide formal assessments of research waste. Emerging topics are however beginning to address some of the issues, for example through methodological improvements in individual studies (e.g.  @fraser2018questionable; @nilsen_bowler_linnell_2019) as well as a focus on open science and evidence synthesis, leading to improved accessibility and reporting  @powers2019open; @gurevitch2018meta. Here we focus on the critical area of question setting, where ecology and conservation can make large steps forward in research waste reduction.

The question setting stage has two related areas where research waste can be reduced by taking into account the existing body of evidence. Firstly, new studies may ask low priority questions - those that are irrelevant to stakeholders. The remedy to this is relatively straightforward; stakeholders should be apart of the research commissioning process @chalmers2009avoidable. Secondly, if a topic has been sufficiently addressed in the existing literature we might already know the outcome with high certainty. Further studies that fail to leverage this existing knowledge are at high risk of wasting precious research resources. 

In medicine, one way in which this particular type of research waste has been identified is by conducting cumulative meta-analysis based on effect sizes from previous studies. A cumulative meta-analysis typically describes the accumulation of evidence (e.g., about the effectiveness of an intervention) across time, and available estimates are added to the analysis in chronological order  @lau1992cumulative. Using cumulative meta-analysis, a researcher, funding agency or decision maker can identify the point at which there is sufficient evidence to be confident that a reported effect is true. At this stage new trials are no longer required to predict the outcome with satisfactory certainty.

As an example of the approach applied to an applied ecology situation we can look at the potential of autonomous acoustic recorders to replace human observers in wildlife sampling and monitoring, which now has a long history in the ecological literature (starting from at least @ralph1995monitoring). Technological advances over the last two decades have allowed this potential to be explored fully. Well over 150 field studies have been carried out that address this issue either directly or indirectly and seek to address the question of whether acoustic recorders can replace human observers in wildlife surveys. A meta-analysis in 20189 explored the pooled effect of these studies using a meta-analytic approach to estimate species richness of birds. Based on the combined evidence from the included studies, they concluded that when human observers (using point counts) and sound recorders sample areas of equal size then there is no difference between estimates of bird species richness. When properly conducted (see specific advice in @darras2018comparing), it can be inferred that sound recorders can be used to monitor aspects of biodiversity as efficiently as human observers. Twenty-eight primary studies published between 2000 and 2017 were included in their meta-analysis. 

Taking the role as a research funder or researcher at the question setting stage, it would be valuable if we could know if we need another study quantifying the difference between acoustic recorders and human observers for bird survey point counts to make this conclusion? This is exactly the situation where the cumulative meta-analysis approach is instrumental. 

We extracted the data and R code from @darras2018comparing to recreate their analysis. Building on their random effects meta-analysis we ran a cumulative meta-analysis using the “cumul” function in the “metafor” @metafor package in R. The cumulative meta-analysis was ordered by publication year and plotted using the “forest” function. To assess the point at which there is sufficient evidence and no further investigations are required we plotted the z-curve in relation to the cumulative sample size. The thresholds for significance was a z value of 1.96 or -1.96. When the z curve crosses this threshold then the level of evidence is considered sufficient. This approach (known as “trial sequential analysis”) is well developed in medicine @wetterslev2008trial. 

The effect size (i.e the magnitude of the difference between intervention and control) of studies investigating the difference between autonomous acoustic recorders and human observers in terms of bird species richness estimates was consistently close to 0 in each study (Figure 3). This means that there was no clear difference between acoustic recorders and human observers on bird point counts. Trial sequential analysis (Figure 2) shows that the significance threshold (between -1.96 and 1.96) was crossed in 2015 favouring automatic recorders over human observers in bird point surveys. This suggests that studies undertaken post 2015 were a “waste” of research resources.

To reduce research waste we need to be able to first quantify it. One option is to use cumulative meta-analysis. The approach demonstrated here is well known and tested in the medical literature. Therefore, it should not be challenging to integrate into conservation and applied ecology workflows. Cumulative meta-analysis has already been used in our field to assess time-lag bias12 but is not commonly used in the way we have shown here. Ideally, funding decisions will take into account the available evidence before giving grants to well studied topics. There may of course be a time lag between identifying that we have sufficient information, and not conducting further research on a topic, due to timescales of publications of original research as well as associated meta-analyses. 

More frequent application of systematic reviews combined with meta-analysis in general, and cumulative meta-analysis in particular, would be one important remedy to reduce research waste in ecology and conservation. However, there are at least two important caveats. First, due to heterogeneity in reporting as well as the drive for novelty in publications, meta-analysis is currently challenging in applied ecology. There might not be sufficient good quality research to quantify the cumulative effect of even some apparently well studied phenomena. In cases such as this one might consider using a systems modelling approach to identify key areas of uncertainty in a topic that could be prioritised for research focus.

Second, it is important to remember that research funding might not only be about answering a research question and could be more targeted to the development of researchers’ skills (PhD students, etc.) or to engaging with stakeholders. Funding for training, skill development and outreach activities should be given appropriate weight in any funding prioritisation.

Research waste can be reduced and it is the responsibility of funders as well as individual researchers to do so. We agree with the statement targeted at medicine 25 years ago that “We need...better research, and research done for the right reasons” @altman1994scandal. Without a change in focus ecology and conservation funding will continue to be wasted which will be detrimental to our efforts to provide solutions to global societal challenges.    


# References {-}

<div id="refs"></div>

\newpage 


```{r Make use of the code from Darras et al, message=FALSE, warning=FALSE, include=FALSE}
#Load libraries
library(readr)
library(data.table)
library(ggplot2)
library(scales)
library(cowplot)
library(metafor)
library(nlme)
library(MuMIn)
library(effects)
library(tidyverse)
library(ggsci)
library(gganimate)
#Code from the original paper (Darras et al. 2018)
#Prepare data and Run metaanalysis
#standard error function
se <- function(x) sqrt(var(x,na.rm=TRUE)/length(na.omit(x)))

meta0=fread("meta-analysis - data.csv")
#give ID to all studies
meta0[,study_ID:=1:nrow(meta0)]
#remove Acevedo due to unequal sampling
meta0=meta0[first_author!="Acevedo"]
#convert to numeric
meta0=meta0[,total_time_min:=as.numeric(total_time_min)]

# Table 1 -----------------------------------------------------------------

#format column headers
meta.studies=meta0[,.(Publication=paste(first_author,year),`Sampling time (min)`=total_time_min,Microphone=microphone,`Signal to noise ratio (minimum, dB)`=signal_to_noise,`Height (cm)`=height_cm,`Number of Microphones`=number_microphones)]

# community differences ---------------------------------------------------

#compute total richness with both methods combined
meta0[,c("gamma_total_unlimited","gamma_total_identical")
      :=.(gamma_point_unlimited+unique_sound_unlimited,gamma_point_identical+unique_sound_identical)]

meta0[simultaneous_methods==1,.(common_species_unlimited=mean((gamma_point_unlimited-unique_point_unlimited)/gamma_total_unlimited,na.rm=T)
                                ,unique_point_unlimited=mean(unique_point_unlimited/gamma_total_unlimited,na.rm=T)
                                ,unique_sound_unlimited=mean(unique_sound_unlimited/gamma_total_unlimited,na.rm=T)
                                ,common_species_identical=mean((gamma_point_identical-unique_point_identical)/gamma_total_identical,na.rm=T)
                                ,unique_point_identical=mean(unique_point_identical/gamma_total_identical,na.rm=T)
                                ,unique_sound_identical=mean(unique_sound_identical/gamma_total_identical,na.rm=T))]

# calculate ROM ----------------------------------------------------------

#calculate log transformed ratio of means for alpha and gamma richness
#alpha richness identical
alpha.identical=data.table(summary(escalc(measure="ROM"
                                          ,m1i=alpha_sound_identical,m2i=alpha_point_identical
                                          ,sd1i=alpha_sound_sd_identical,sd2i=alpha_point_sd_identical
                                          ,n1i=alpha_sound_n_identical,n2i=alpha_point_n_identical
                                          ,data=meta0[!is.na(alpha_point_n_identical)])))

#alpha richness unlimited
alpha.unlimited=data.table(summary(escalc(measure="ROM"
                                          ,m1i=alpha_sound_unlimited,m2i=alpha_point_unlimited
                                          ,sd1i=alpha_sound_sd_unlimited,sd2i=alpha_point_sd_unlimited
                                          ,n1i=alpha_sound_n_unlimited,n2i=alpha_point_n_unlimited
                                          ,data=meta0[!is.na(alpha_point_n_unlimited)])))
#gamma richness identical
gamma.identical=data.table(summary(escalc(measure="ROM"
                                          ,m1i=gamma_sound_identical,m2i=gamma_point_identical
                                          ,sd1i=rep(0,nrow(meta0[!is.na(gamma_total_identical)])),sd2i=rep(0,nrow(meta0[!is.na(gamma_total_identical)]))
                                          ,n1i=total_time_min,n2i=total_time_min
                                          ,data=meta0[!is.na(gamma_total_identical)])))

#gamma richness unlimited
gamma.unlimited=data.table(summary(escalc(measure="ROM"
                                          ,m1i=gamma_sound_unlimited,m2i=gamma_point_unlimited
                                          ,sd1i=rep(0,nrow(meta0[!is.na(gamma_total_unlimited)])),sd2i=rep(0,nrow(meta0[!is.na(gamma_total_unlimited)]))
                                          ,n1i=total_time_min,n2i=total_time_min
                                          ,data=meta0[!is.na(gamma_total_unlimited)])))

#merge all ROM data together
meta1=merge(meta0,merge(alpha.identical[,.(study_ID,alpha_ROM_identical=yi,alpha_variance_ROM_identical=vi,alpha_ci.lb_identical=ci.lb,alpha_ci.ub_identical=ci.ub)]
                        ,merge(alpha.unlimited[,.(study_ID,alpha_ROM_unlimited=yi,alpha_variance_ROM_unlimited=vi,alpha_ci.lb_unlimited=ci.lb,alpha_ci.ub_unlimited=ci.ub)]
                               ,merge(gamma.unlimited[,.(study_ID,gamma_ROM_unlimited=yi,gamma_variance_ROM_unlimited=vi)]
                                      ,gamma.identical[,.(study_ID,gamma_ROM_identical=yi,gamma_variance_ROM_identical=vi)]
                                      ,all=T,by="study_ID"),all=T,by="study_ID"),all=T,by="study_ID"),all=T,by="study_ID")


# identical range (alpha) --------------------------------------------------------------

#create publication=level column for random effect
meta1[,publication:=paste(first_author,year)]

#models for identical ranges
RMA_alpha_identical=rma.mv(yi=alpha_ROM_identical,V=alpha_variance_ROM_identical
                           ,data=meta1,random=list(~1|publication))

```


```{r flowc, echo=FALSE, message=FALSE, warning=FALSE, fig.cap= "The production of research flows through four stages all of which can lead to research waste [@fraser2018questionable]. Ecology and conservation have begun to reduce waste by focusing on methodological improvements and open science. Evidence synthesis (including reporting to decision makers) can be considered another stage of research production. The failure to make use of the available evidence in the design of new studies is another avenue to research waste. The use of cumulative meta-analysis is one way in which this type of research waste can be reduced.\\label{flow}"}
library(DiagrammeR)

grViz("
digraph boxes_and_circles {

  # a 'graph' statement
  graph [overlap = true, fontsize = 10]

  # several 'node' statements
  node [shape = box,
        fontname = Helvetica]
      tab1 [label = '@@1',color = blue]
      tab2 [label = '@@2',color = blue]
      tab3 [label = '@@3',color = blue]
      tab4 [label = '@@4',color = blue]
      tab5 [label = '@@5',color = red]
  node [shape = circle,
        fixedsize = true,
        width = 2, color=green] // sets as circles
    tab6 [label = '@@6']
    # several 'edge' statements
 tab1->tab2->tab3->tab4
 tab1->tab5
  tab2->tab5
   tab3->tab5
    tab4->tab5
    tab4->tab6 
    tab6->tab1 [style=dotted]
        tab6->tab2 [style=dotted]
        tab6->tab5 [style=dashed]
    
}
      [1]: 'Questions relevant to stakeholders'
      [2]: 'Appropriate design & methods'
      [3]: 'Accessible full publication'
      [4]: 'Unbiased reporting'
      [5]: 'Research waste'
      [6]: 'Evidence synthesis'
", height=1000)

```


```{r Add seq, echo=FALSE, message=FALSE, warning=FALSE, fig.cap= "Trial sequential analysis. The red dashed lines indicate the significance threshold (between -1.96 and 1.96). When the z-curve crosses the red line then there is sufficient evidence and no new trials are required [@ggplot2]. \\label{seq}"}
res <- rma(RMA_alpha_identical$yi, RMA_alpha_identical$vi, data=meta1, slab=paste(meta1$first_author, meta1$year, sep=", "))
cres<-cumul(res, order=order(meta1$year))
cumzval<-cumsum(cres$zval)
cum_sample<-cumsum(meta1$alpha_point_n_identical)  
# cum_sample<-c(136,              186,
#               190,              238,
#               363,              419,
#               455,              516,
#               577,              647,
#               660,              720,
#               780,              878,
#               894,              898,
#               922,              930,
#               1103,              1113,
#               1172,              1633,
#               1666,              1710,
#               1752,              1784,
#               1814)

Year=meta1$year

Year=gsub("a","",Year)
Year=gsub("b","",Year)
Year<-as.integer(Year)
Year<-Year[order(Year)]
# Year=c(2000,2002,2002,2002,2004,2009,2009,2009,2012,2012,2012,2012,2012,
# 2014,2015,2015,2015,2015,2015,2016,2016,2016,2016,2017,2017,2017,2018)
library(ggrepel)
cum_df<-data.frame("z-score"=cumzval, "Cumulative n"=cum_sample, "Year"=Year)


cum_df2<-cum_df[c(1,18,27),]
#png("TSA.png", width=850, height =400)
cum_df %>% 
  ggplot(aes(cum_sample,z.score, colour=as.factor(Year)))+
  scale_fill_npg()+
  labs(y="Cumulative z score", x="Cumulative sample size")+
  geom_point(size=6)+
  geom_line(colour="blue", linetype="dashed", size=1)+
  ylim(c(-20,20))+
  xlim(c(0,2000))+
  
  #annotate("text", x = 1, y = 10, label = sprintf('\u2b61'),size=30) +
  #annotate("text", x = 3000, y = 10, label ="Favours automatic recorder",size=4) +
  #annotate("text", x = 1, y = -10, label = sprintf('\u2b63'),size=30) +
  #annotate("text", x = 3000, y = -10, label ="Favours human recorder",size=4) +
  geom_text(data=cum_df2, aes(Cumulative.n,z.score,label=as.factor(Year)),hjust=1.3, vjust=1, colour="black")+
  
  #geom_text(aes(label=as.factor(Year)),hjust=0.5, vjust=0)+
  geom_hline(yintercept = 2, colour="red",linetype="dotted", size=1.6)+
  geom_hline(yintercept = -2, colour="red",linetype="dotted", size=1.6)+
  theme_classic() +
  theme(axis.line = element_line(size = 1.6, color = rgb(0,0,0,max=255)))+
  theme(legend.position = "none")+
  theme(text=element_text(size=16,  family="serif"))
```


```{r Add Trial, echo=FALSE, message=FALSE, warning=FALSE, fig.cap= "Cumulative forest plot of the meta-analysis of Darras et al. (2018) on the difference between human observers and acoustic recorders in terms of species richness.\\label{forest}"}
### Add cumulative meta-analysis

forest(cres, col="blue")
```


