---
title: "Evidence accumulation for tackling research waste"
csl: nature.csl
output:
  pdf_document:
    fig_caption: yes
  word_document: 
    fig_caption: yes
  html_document: 
    fig_caption: yes
bibliography: bibliography.bib
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```



Matthew J. Grainger^1^*, Friederike C. Bolam^2^, Gavin B. Stewart^2^, Erlend B. Nilsen^1^

^1^Norwegian Institute for Nature Research, P.O. Box 5685 Torgarden, 7485, Trondheim, Norway

^2^Modelling Evidence and Policy Research Group, School of Natural and Environmental Sciences, Ridley Building 2, Claremont Road, Newcastle upon Tyne NE1 7RU, UK  


*corresponding author: matthew.grainger\@nina.no

*There is an urgent need for a change in research workflows so that pre-existing knowledge is better utilised in designing new research. A formal assessment of the accumulated knowledge prior to research approval would reduce the waste of already limited resources caused by asking low priority questions.*  

“Research waste” is a well-established concept in medical research[@glasziou2018research]. Research is wasted when its outcomes cannot be used for the benefit of society [@chalmers2009avoidable], for example because no new knowledge is gained or the knowledge gained cannot be applied. Waste can occur at any of the four stages of the research process [@chalmers2009avoidable]; question setting; methods; accessibility; and reporting (Table 1). In medicine, global research waste was estimated in 2009 to cost US $85 bn [@chalmers2009avoidable], with few signs of improvement in the last decade [@glasziou2018research]. There is little reason to believe that the situation is substantially different in ecology and conservation, although there are no field-wide formal assessments of research waste.

Emerging topics are beginning to address some of the factors that result in wasted research efforts (Table 1). In particular, there is increased focus on methodological improvements in individual studies (e.g. [@fraser2018questionable], [@nilsen_bowler_linnell_2019]),  and on open science leading to improved accessibility and reporting [@gurevitch2018meta], [@powers2019open]. Less formal effort is devoted to the question setting stage. Here we suggest that “Evidence Synthesis” should be considered an additional stage of research (Table1, Figure S1). Evidence synthesis methods close the research process into a loop, and will have additional benefits in terms of reducing research waste at the question setting stage. 

# Reducing waste in question setting

There are two related areas where research waste can be reduced by taking into account the existing body of evidence by applying evidence synthesis methods.

## Low priority questions

New studies may ask low priority questions - those that are irrelevant to stakeholders. The remedy to this is to include stakeholders in the research commissioning process[@chalmers2009avoidable]. Evidence synthesis, or horizon scanning for novel problems, should be used to provide evidence to practitioners, researchers and other stakeholders so that they can identify research gaps that are important to them and to develop future questions [@gold2013prioritizing].

## The answer is already known with certainty

If a topic has been sufficiently addressed in the existing literature we might already know the outcome with high certainty. Further studies that fail to leverage this existing knowledge are at high risk of wasting limited research resources. There are a variety of tools available for research-funders and researchers to assess the state of knowledge on the topic of interest. For example, systematic maps (also known as Evidence gap maps or Evidence maps), were designed to give an overview of the available evidence on a broad topic [@saran2018evidence]. They can highlight where there is enough available evidence for a systematic review or where primary research is required (i.e. there is a lack of evidence). Systematic reviews can be used to synthesise knowledge about a narrow topic such as the evidence for the effectiveness of an intervention and can provide a statistical summary of the pooled effect size. The statistical combination of numerical data extracted from the evidence base during the process of a systematic review is known as meta-analysis. Meta-analysis is commonly used in conservation and ecology6 providing an understanding of the magnitude of the known effect of an intervention across individual studies. These results can then be used to identify what a new research project can add to the current evidence base. 

# Identifying research waste with cumulative meta-analysis
In medicine, one additional tool used to quantify research waste is cumulative meta-analysis. A cumulative meta-analysis typically describes the accumulation of evidence (e.g., about the effectiveness of an intervention) across time, and available estimates are added to the analysis in chronological order [@lau1992cumulative]. Using cumulative meta-analysis, a researcher, funding agency or decision maker can identify if there is sufficient evidence to be confident that a reported effect is true. At this stage new trials are no longer required to predict the outcome with satisfactory certainty and hence future research waste will be avoided.

## An applied example
As an example of the approach within an applied ecology situation, we consider to what extent autonomous acoustic recorders can replace human observers in wildlife sampling and monitoring when the focus is on estimating species richness, which now has a long history in the ecological literature [@darras2018comparing]. Technological advances over the last two decades have allowed this potential to be explored fully, and well over 150 field studies have sought to answer this question. A meta-analysis in 2018[@darras2018comparing] explored the pooled effect of these studies using a meta-analytic approach to estimate species richness of birds. Based on the combined evidence from the included studies, they concluded that when human observers (using point counts) and sound recorders sample areas of equal size then there is no difference between estimates of bird species richness. When properly conducted (see specific advice in [@darras2018comparing]), it can be inferred that sound recorders can be used to monitor aspects of biodiversity as efficiently as human observers. Twenty-eight primary studies published between 2000 and 2017 were included in the meta-analysis. 
Taking the role as a research funder or researcher at the question setting stage, we can utilise cumulative meta-analysis to determine if we need another study quantifying the difference between acoustic recorders and human observers for bird survey point counts. We adapted the analysis of [@darras2018comparing] to demonstrate the use of cumulative meta-analysis (see supplementary materials). The effect size (i.e the magnitude of the difference between intervention and control) of studies investigating the difference between autonomous acoustic recorders and human observers in terms of bird species richness estimates was consistently close to 0.07 since 2015 (Figure 1). This means that there was no clear difference between acoustic recorders and human observers on bird point counts. It would therefore be wasteful to fund yet another study that addressed this specific question.
To reduce research waste we need to be able to first identify it. One option is to use cumulative meta-analysis. The approach demonstrated here is well known and tested in the medical literature and should not be challenging to integrate into conservation and applied ecology workflows. Cumulative meta-analysis has already been used in our field to assess time-lag bias [@leimu2004cumulative] but is not commonly used in the way we have shown here. 

## Caveats
There are several important caveats that need to be addressed. The heterogeneity in reporting and the drive for novelty in publications means that meta-analysis is currently challenging in applied ecology. There might not be sufficient good quality research to quantify the cumulative effect of even some apparently well studied phenomena. Researchers are best placed to add to the evidence base by ensuring that they use of comparable measures of outcomes rather than novel ones.  
In addition, publication bias, where the direction of statistical significance of the outcome influences the decision to publish the result, might bias the evidence base available. This is a major caveat for all evidence synthesis approaches, but one which can be identified. With cumulative meta-analysis one can identify publication bias11 by accumulating the effect sizes in order of journal impact factor for example. Although this method makes it possible to detect publication bias it will not not solve the underlying problem, and researchers should endeavour to reduce publication bias by following open science (Table 1). 
There may of course be a time lag between identifying that we have sufficient information, and not conducting further research on a topic, due to timescales of publications of original research as well as associated meta-analyses. 
To address these and other issues around evidence synthesis we have been exploring a systems modelling approach to combine empirical evidence from systematic reviews and meta-analysis with expert opinion which allows key areas of uncertainty in a topic to be identified and prioritised for research focus (e.g. [@carrick2018planting]).

## Outlook
Research waste can be reduced and it is the responsibility of funders as well as individual researchers to do so. We agree with the statement targeted at medicine 25 years ago that “We need...better research, and research done for the right reasons” [@altman1994scandal]. Without a change in focus ecology and conservation funding will continue to be wasted which will be detrimental to our efforts to provide solutions to global societal challenges.   


# Supplementary Information

## Methods
We extracted the data and R code from the supplementary information in [@darras2018comparing] to recreate their analysis. As such we are dependant on the accurate extraction of data from the primary studies by the original authors. We intended our re-analysis of their data to be an example of the cumulative meta-analysis approach rather than to make explicit recommendations about the use of acoustic recorders for avian surveys. Building on their random effects meta-analysis we ran a cumulative meta-analysis using the “cumul” function in the “metafor” [@metafor] package in R. The cumulative meta-analysis was ordered by publication year and plotted using the ggplot2 package in R [@ggplot2] . Where a single study provided more than one estimate of effect the order in which the estimates were accumulated was the same as the order presented by [@darras2018comparing] and treated as subsequent trials. Changing the order of that these particular studies were accumulated made no difference to the stability of the estimates over time (see Figure 3). The original code, the original data, our additional code for running the analysis and plotting can be found at https://github.com/DrMattG/Research_waste.


# References {-}

<div id="refs"></div>

\newpage 


```{r Make use of the code from Darras et al, message=FALSE, warning=FALSE, include=FALSE}
#Load libraries
library(readr)
library(data.table)
library(ggplot2)
library(scales)
library(cowplot)
library(metafor)
library(nlme)
library(MuMIn)
library(effects)
library(tidyverse)
library(ggsci)
library(gganimate)
library(ggthemes)
library(bookdown)

#Code from the original paper (Darras et al. 2018)
#Prepare data and Run metaanalysis
#standard error function
se <- function(x) sqrt(var(x,na.rm=TRUE)/length(na.omit(x)))

meta0=fread("meta-analysis - data.csv")
#give ID to all studies
meta0[,study_ID:=1:nrow(meta0)]
#remove Acevedo due to unequal sampling
meta0=meta0[first_author!="Acevedo"]
#convert to numeric
meta0=meta0[,total_time_min:=as.numeric(total_time_min)]

# Table 1 -----------------------------------------------------------------

#format column headers
meta.studies=meta0[,.(Publication=paste(first_author,year),`Sampling time (min)`=total_time_min,Microphone=microphone,`Signal to noise ratio (minimum, dB)`=signal_to_noise,`Height (cm)`=height_cm,`Number of Microphones`=number_microphones)]

# community differences ---------------------------------------------------

#compute total richness with both methods combined
meta0[,c("gamma_total_unlimited","gamma_total_identical")
      :=.(gamma_point_unlimited+unique_sound_unlimited,gamma_point_identical+unique_sound_identical)]

meta0[simultaneous_methods==1,.(common_species_unlimited=mean((gamma_point_unlimited-unique_point_unlimited)/gamma_total_unlimited,na.rm=T)
                                ,unique_point_unlimited=mean(unique_point_unlimited/gamma_total_unlimited,na.rm=T)
                                ,unique_sound_unlimited=mean(unique_sound_unlimited/gamma_total_unlimited,na.rm=T)
                                ,common_species_identical=mean((gamma_point_identical-unique_point_identical)/gamma_total_identical,na.rm=T)
                                ,unique_point_identical=mean(unique_point_identical/gamma_total_identical,na.rm=T)
                                ,unique_sound_identical=mean(unique_sound_identical/gamma_total_identical,na.rm=T))]

# calculate ROM ----------------------------------------------------------

#calculate log transformed ratio of means for alpha and gamma richness
#alpha richness identical
alpha.identical=data.table(summary(escalc(measure="ROM"
                                          ,m1i=alpha_sound_identical,m2i=alpha_point_identical
                                          ,sd1i=alpha_sound_sd_identical,sd2i=alpha_point_sd_identical
                                          ,n1i=alpha_sound_n_identical,n2i=alpha_point_n_identical
                                          ,data=meta0[!is.na(alpha_point_n_identical)])))

#alpha richness unlimited
alpha.unlimited=data.table(summary(escalc(measure="ROM"
                                          ,m1i=alpha_sound_unlimited,m2i=alpha_point_unlimited
                                          ,sd1i=alpha_sound_sd_unlimited,sd2i=alpha_point_sd_unlimited
                                          ,n1i=alpha_sound_n_unlimited,n2i=alpha_point_n_unlimited
                                          ,data=meta0[!is.na(alpha_point_n_unlimited)])))
#gamma richness identical
gamma.identical=data.table(summary(escalc(measure="ROM"
                                          ,m1i=gamma_sound_identical,m2i=gamma_point_identical
                                          ,sd1i=rep(0,nrow(meta0[!is.na(gamma_total_identical)])),sd2i=rep(0,nrow(meta0[!is.na(gamma_total_identical)]))
                                          ,n1i=total_time_min,n2i=total_time_min
                                          ,data=meta0[!is.na(gamma_total_identical)])))

#gamma richness unlimited
gamma.unlimited=data.table(summary(escalc(measure="ROM"
                                          ,m1i=gamma_sound_unlimited,m2i=gamma_point_unlimited
                                          ,sd1i=rep(0,nrow(meta0[!is.na(gamma_total_unlimited)])),sd2i=rep(0,nrow(meta0[!is.na(gamma_total_unlimited)]))
                                          ,n1i=total_time_min,n2i=total_time_min
                                          ,data=meta0[!is.na(gamma_total_unlimited)])))

#merge all ROM data together
meta1=merge(meta0,merge(alpha.identical[,.(study_ID,alpha_ROM_identical=yi,alpha_variance_ROM_identical=vi,alpha_ci.lb_identical=ci.lb,alpha_ci.ub_identical=ci.ub)]
                        ,merge(alpha.unlimited[,.(study_ID,alpha_ROM_unlimited=yi,alpha_variance_ROM_unlimited=vi,alpha_ci.lb_unlimited=ci.lb,alpha_ci.ub_unlimited=ci.ub)]
                               ,merge(gamma.unlimited[,.(study_ID,gamma_ROM_unlimited=yi,gamma_variance_ROM_unlimited=vi)]
                                      ,gamma.identical[,.(study_ID,gamma_ROM_identical=yi,gamma_variance_ROM_identical=vi)]
                                      ,all=T,by="study_ID"),all=T,by="study_ID"),all=T,by="study_ID"),all=T,by="study_ID")


# identical range (alpha) --------------------------------------------------------------

#create publication=level column for random effect
meta1[,publication:=paste(first_author,year)]
meta1<-meta1 %>% 
  mutate("year"=gsub("a"," ", year)) %>% 
  mutate("year"=gsub("b"," ", year))


#models for identical ranges
RMA_alpha_identical=rma.mv(yi=alpha_ROM_identical,V=alpha_variance_ROM_identical
                           ,data=meta1,random=list(~1|publication))
forest(RMA_alpha_identical)

```





```{r Add Trial, echo=FALSE, message=FALSE, warning=FALSE, fig.cap= "Cumulative forest plot of the meta-analysis of Darras et al. (2018) on the difference between human observers and acoustic recorders in terms of species richness.\\label{forest}"}
### Add cumulative meta-analysis
res <- rma(RMA_alpha_identical$yi, RMA_alpha_identical$vi, data=meta1, slab=paste(meta1$first_author, meta1$year, sep=", "))
cres<-cumul(res, order=order(meta1$year))
#forest(cres, col="blue")
df<-data.frame("cite"=cres$slab, "est"=cres$estimate, "se"=cres$se)

p<-df %>% 
  rowid_to_column() %>% 
  mutate("Up"=(1.96*se)+est) %>% 
  mutate("Low"=(-1.96*se)+est) %>% 
  ggplot(aes(y=reorder(cite,-rowid), x=est, xmin=Low, xmax=Up))+
  geom_point(color = 'blue', size=3)+
  labs(x="Log ratio of means", y="")+
  geom_vline(xintercept = 0, linetype = "dashed", colour="green", size=1)+
  geom_errorbarh(height=.1, colour="blue", size=1)+
  ggthemes::theme_base()+
  theme(axis.line = element_line(colour = 'black', size = 1), 
        axis.ticks = element_line(colour = "black", size = 1))
p

```


```{r flowc, echo=FALSE, message=FALSE, warning=FALSE, fig.cap= "The production of research flows through five stages (blue lines) all of which can lead to research waste [@@chalmers2009avoidable] (red dashed lines). Ecology and conservation have begun to reduce waste by focusing on methodological improvements and open science. Evidence synthesis (including reporting to decision makers) can contribute to the reduction in research waste by influencing question setting and appropriate methods and design (black dashed lines).\\label{flow}"}
library(DiagrammeR)

grViz("
digraph boxes_and_circles {

  # a 'graph' statement
  graph [overlap = true, fontsize = 10]

  # several 'node' statements
  node [shape = box,
        fontname = Helvetica]
      tab1 [label = '@@1',color = blue]
      tab2 [label = '@@2',color = blue]
      tab3 [label = '@@3',color = blue]
      tab4 [label = '@@4',color = blue]
      tab6 [label = '@@6',color = blue]
      tab8 [label = '@@8',color = red]
      tab9 [label = '@@9',color = red]
      tab10[label = '@@10',color = red]
      tab11[label = '@@11',color = red]
      
  node [shape = circle,
        fixedsize = true,
        width = 2, color=blue] // sets as circles
    tab7 [label = '@@7']
    
    node [shape = circle,
        fixedsize = true,
        width = 2, color=red] // sets as circles
    tab5 [label = '@@5']
  
    
    # several 'edge' statements
 tab1->tab2->tab3->tab4->tab6->tab7 [color=blue]
 tab1->tab8 [color=red,style=dashed]
  tab2->tab9 [color=red,style=dashed]
   tab3->tab10 [color=red,style=dashed]
    tab4->tab11 [color=red,style=dashed]
    tab8->tab5[color=red,style=dashed]
    tab9->tab5[color=red,style=dashed]
    tab10->tab5[color=red,style=dashed]
    tab11->tab5[color=red,style=dashed]
    tab6->tab1 [style=dashed]
        tab6->tab2 [style=dashed]
    tab6->tab5 [color=red, style=dashed]
        
 }
      [1]: 'Questions relevant to stakeholders'
      [2]: 'Appropriate design & methods'
      [3]: 'Unbiased reporting'
      [4]: 'Accessible full publication'
      [5]: 'Wasteful research'
      [6]: 'Evidence synthesis'
      [7]: 'Utilisable research' 
      [8]: 'Previous knowledge not accounted for'
      [9]: 'Poor design; \\nquestionable research practices'
      [10]: 'Lack of transparency'
      [11]: 'Publications not available to practitioners \\n& decision makers'
  ", height=1000)

```


```{r Randomise order of the estimates in the same study,echo=FALSE, message=FALSE, warning=FALSE, fig.cap= "Cumulative forest plot of the meta-analysis of Darras et al. (2018) on the difference between human observers and acoustic recorders in terms of species richness. Estimates from the same study inputted in random order\\label{forestX}"}
set.seed(8955)
metax<-meta1
metax$order<-order(metax$year, runif(length(metax$year))) 
res2 <- rma(RMA_alpha_identical$yi, RMA_alpha_identical$vi, data=metax, slab=paste(metax$first_author, metax$year, sep=","))
cres2<-cumul(res2, order=order(metax$order))
par(mfrow=c(1,2))
forest(cres2)
forest(cres)

```

Table 1 can be found at: https://github.com/DrMattG/Research_waste/blob/master/Manuscript/Table1.pdf

```{r, echo=FALSE}



# df<-data.frame("Research Stage"=c("Questions relevant to stakeholders","Questions relevant to stakeholders","Appropriate design and methods","Appropriate design and methods",
#                                   "Appropriate design and methods","Appropriate design and methods","Unbiased reporting","Unbiased reporting","Unbiased reporting","Unbiased reporting",
#                                   "Unbiased reporting","Accessible full publication","Evidence synthesis"),
#                "Examples of potential for research waste"=c("Irrelevant questions asked","Previous knowledge not properly taken into account","Study poorly designed, under-powered (or over-powered. etc.)",
#                                                             "Using inappropriate statistical tools (including overfitting etc.)","Questionable research practices3 lead to poor quality research","Questionable research practices3 lead to poor quality research",
#                                                             "Lack of open data","Hypothesising after the results are known","p-hacking","File-drawer syndrome (only some studies are published)","Incomplete reporting, making evidence synthesis difficult or impossible",
#                                                             "Publications not available to practitioners and decision makers","Research not designed or presented in the context of the existing knowledge"),
#                "Where ecology and conservation can reduce waste"=c("Co-development of research questions with stakeholders and using appropriate methodology such as Delphi exercises to avoid issues such as group think or not including the right group of experts or stakeholders",
#                "Make use of evidence synthesis methods (e.g. cumulative meta-analysis, systematic mapping, systematic reviews, meta-analysis) to identify questions that are not satisfactorily answered",
#                "Use simulations or power-analysis prior to undertaking data collection. Predefine effect size of interest with stakeholders (i.e. do not rely on rules of thumb for “statistical significance”)",
#                "Better training of early-career researchers in methods. Open code and data to ensure reproducibility of methods",
#                "Open science (open methods and data, reproducible methods, sharing code, etc.)",
#                "Better training of early-career researchers in methods of open science and evidence synthesis",
#                "Open science (open methods and data, reproducible methods, sharing code, etc.)",
#                "Pre-registration of hypotheses",
#                "Open science (open methods and data, reproducible methods, sharing code, etc.)",
#                "Pre-registration of hypotheses and methods. Open publishing (including preprints)",
#                "Increasing knowledge of researchers and peer reviewers on what is essential to report, and changing journal guidelines where necessary to ensure all relevant information is reported",
#                "Open access publishing, including making resources available to researchers to be able to publish open access","Using systematic reviews, systematic maps, meta-analysis, etc. to shape research priorities. Where good quality evidence is available these should be synthesised providing evidence to relevant stakeholders. Research gaps should be the focus of primary studies."
#                ))
# # # kable(df, "latex", booktabs = T, align = "c") %>% column_spec(1, bold=T) %>% collapse_rows(columns = 1:2, latex_hline = "major", valign = "middle")
# library(kableExtra)
# #knitr::kable(df)
# df %>% kable("latex") %>% as_image()

```

